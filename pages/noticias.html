<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Noticias — Mundo Monopoly</title>
  <meta name="description" content="Noticias y novedades sobre Monopoly">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="../css/styles.css" rel="stylesheet">
  <link rel="icon" type="image/svg+xml" href="../assets/icons/favicon.svg">
  <meta name="theme-color" content="#E30613">

  <!-- Skin editorial que ya estabas usando -->
  <style>
  .blog-card{
    display:grid; 
    grid-template-columns: 260px 1fr; 
    gap:1rem;
    background: var(--mm-card-bg);
    color: var(--mm-card-fg);
    border-radius:1rem; 
    padding:1rem;
    border: 1px solid var(--mm-card-border);
    box-shadow: var(--mm-card-shadow);
    transition:transform .15s ease, box-shadow .15s ease;
  }

  .blog-card:hover{ 
    transform:translateY(-3px); 
    box-shadow:0 10px 25px rgba(0,0,0,.15); 
  }

  /* ---- Ajuste visual de las miniaturas ---- */
  .blog-media{
    position: relative;
    display: block;
    border-radius: .75rem;
    overflow: hidden;
    background: #000;
  }

  /* Marco con proporción fija (evita recortes y saltos visuales) */
  .blog-media::before{
    content: "";
    display: block;
    aspect-ratio: 16/9;  /* puedes usar 4/3 o 3/2 si prefieres más alto */
  }

  .blog-media img{
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;      /* llena sin deformar */
    object-position: center;
    display: block;
    border-radius: .75rem;
    transition: transform .3s ease, opacity .25s ease;
  }

  .blog-media:hover img{
    transform: scale(1.03);
    opacity: .95;
  }

  /* Responsivo */
  @media (max-width: 680px){
    .blog-card{ grid-template-columns: 1fr }
    .blog-media::before{ aspect-ratio: 4/3; }
  }

  .blog-body{
    display:flex; 
    flex-direction:column;
  }

  .blog-title{
    font-weight:700; 
    font-size:1.2rem; 
    margin:.25rem 0;
  }

  .blog-snippet{ 
    color: var(--mm-muted); 
  }

  .meta{
    font-size:.85rem; 
    color: var(--mm-muted); 
    display:flex; 
    align-items:center; 
    gap:.5rem;
  }

  .meta .dot{ 
    width:4px; 
    height:4px; 
    border-radius:50%; 
    background:#bbb; 
    display:inline-block; 
  }

  .cat{
    font-size:.7rem; 
    font-weight:700; 
    padding:.2rem .5rem; 
    border-radius:.5rem; 
    text-transform:uppercase; 
    letter-spacing:.02em;
  }

  .blog-card a{
    color:inherit; 
    text-decoration:none;
  }

  .blog-card a:hover{
    text-decoration:underline;
  }

  .blog-card{
    cursor:default;
  }

  .blog-card a, 
  .blog-card button{
    cursor:pointer;
  }

  #contenedor-noticias .stretched-link::after{
    content:none!important;
  }
</style>


</head>

<body>
  <!-- NAVBAR COMPLETO (todas las secciones) -->
  <nav class="navbar navbar-expand-lg navbar-carbon fixed-top">
    <div class="container">
      <a class="navbar-brand" href="../index.html">
        <img src="../assets/icons/logo.svg" alt="Mundo Monopoly" height="40">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link" href="../index.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="./historia.html">Historia</a></li>
          <li class="nav-item"><a class="nav-link" href="./reglas.html">Reglas</a></li>
          <li class="nav-item"><a class="nav-link" href="./piezas.html">Piezas</a></li>
          <li class="nav-item"><a class="nav-link" href="./estrategias.html">Estrategias</a></li>
          <li class="nav-item"><a class="nav-link" href="./productos.html">Productos</a></li>
          <li class="nav-item"><a class="nav-link active" href="./noticias.html">Noticias</a></li>
          <li class="nav-item"><a class="nav-link" href="./contacto.html">Contacto</a></li>
        </ul>
        <div class="d-flex ms-auto">
          <button id="darkModeToggle" class="btn btn-outline-light" type="button" title="Modo oscuro">
            <i class="bi bi-moon-stars"></i>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- CONTENIDO -->
  <main class="container py-5 mt-4">
    <h1 class="mb-4 text-center">Noticias y novedades</h1>
    <div id="contenedor-noticias" class="row g-4"></div>
  </main>

  <!-- FOOTER -->
  <footer class="bg-dark text-light py-4 text-center">
    &copy; 2025 Mundo Monopoly
  </footer>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../js/scripts.js"></script>
  
  <script>
  document.addEventListener('DOMContentLoaded', async () => {
    const grid = document.getElementById('contenedor-noticias');
    const JSON_URL  = '../assets/data/noticias.json';
    const DETAIL_URL = './noticia.html';

    const catClass = (c='') => {
      const k = c.toLowerCase();
      if (k.includes('curios')) return 'cat-curiosidades';
      if (k.includes('compet')) return 'cat-competencias';
      return 'cat-general';
    };
    const fmtFecha = (iso) => {
      try { return new Date(iso).toLocaleDateString('es-DO', {year:'numeric', month:'long', day:'numeric'}); }
      catch { return iso || ''; }
    };

    try {
      const res = await fetch(JSON_URL, { cache:'force-cache' });
      const data = await res.json();
      const base = (Array.isArray(data) ? data : data.noticias) || [];

      // Orden único para lista y detalle:
      const sorted = base.slice().sort((a,b) => new Date(b.fecha)-new Date(a.fecha));
      sessionStorage.setItem('MM_NEWS_JSON_SORTED', JSON.stringify(sorted));

      grid.innerHTML = '';
      sorted.forEach((n,i)=>{
        const mins = Math.max(1, Math.round(((n.snippet||'').split(/\s+/).length)/200));
        const to = `${DETAIL_URL}?slug=${encodeURIComponent(n.slug)}&nid=${i}`;
        grid.insertAdjacentHTML('beforeend',`
          <div class="col-12">
            <article class="blog-card">
              <a class="blog-media hard-nav" href="${to}">
                <img src="${n.imagen}" alt="${n.titulo||'Noticia'}" loading="lazy" decoding="async">
              </a>
              <div class="blog-body">
                <div class="d-flex align-items-center gap-2 flex-wrap">
                  <span class="cat ${catClass(n.categoria)}">${(n.categoria||'General').toUpperCase()}</span>
                  <div class="meta"><span>${fmtFecha(n.fecha)}</span><span class="dot"></span><span>${mins} min de lectura</span></div>
                </div>
                <h2 class="blog-title"><a href="${to}" class="text-reset hard-nav">${n.titulo||''}</a></h2>
                <p class="blog-snippet mb-0">${n.snippet||''}</p>
                <div class="mt-auto pt-2">
                  <a class="btn btn-sm btn-primary hard-nav" href="${to}">Leer más</a>
                  ${n.url ? `<a class="btn btn-sm btn-outline-secondary ms-1" href="${n.url}" target="_blank" rel="noopener">Fuente</a>` : ''}
                </div>
              </div>
            </article>
          </div>`);
      });

      // Navegación dura (evita interceptores SPA)
      grid.addEventListener('click',(ev)=>{
        const a=ev.target.closest('a.hard-nav');
        if(!a) return;
        const href=a.getAttribute('href');
        if(!href||/^https?:\/\//i.test(href))return;
        ev.preventDefault();ev.stopPropagation();
        if(ev.stopImmediatePropagation)ev.stopImmediatePropagation();
        a.setAttribute('target','_self');
        window.location.assign(href);
      },true);

    } catch(e){
      console.error(e);
      grid.innerHTML='<div class="alert alert-danger text-center">Error cargando noticias.</div>';
    }
  });
  </script>
</body>
</html>
